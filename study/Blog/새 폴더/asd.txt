CREATE TABLE orders( 
    id number(9,0),                       
    customerId number(9,0),
    productId number(9,0),
    CONSTRAINT orders_pk PRIMARY KEY(id),
    CONSTRAINT orders_customer_fk FOREIGN key(customerId) REFERENCES customer(id),
    CONSTRAINT orders_customer_fk FOREIGN key(productId) REFERENCES product(id)
); 
ALTER TABLE orders;
    

CREATE TABLE customer (
    id number(9,0),                        -- 유저 번호를 의미 4,0 => 9999가 MAX임 ( 만명째 부터 못받음 )
    username varchar2(12) not null,        -- varchar2 : 영어를 256자 넣을 수 있음 (8bit), (12): 12자 까지만 적어야함. 필수 입력값
    password varchar2(20) not null,        -- 비밀번호 20자 까지만. 필수 입력값
    email varchar(50),
    CONSTRAINT customer_pk PRIMARY KEY(id), -- id를 PRIMARY KEY로 만들겠다. id는 자동으로 not null이 됨, 자동으로 인덱스가 걸림, 중복이 안되게 만들어야 함.
    CONSTRAINT customer_uesrname_uk UNIQUE(username) 
);                              

select * 
from customer;

select *
from orders;

CREATE SEQUENCE  PRODUCT_SEQ  
START WITH 1 
INCREMENT BY 1;

drop SEQUENCE orders_seq;
CREATE SEQUENCE  orders_SEQ  
START WITH 1 
INCREMENT BY 1;

INSERT INTO customer(id, username, password) VALUES(customer_seq.nextval, 'cos', '1234');

SELECT *
FROM customer;

rollback;
INSERT INTO customer(id, username, password) VALUES(customer_seq.nextval, 'cos', '1234');
SELECT *
FROM customer;

DROP SEQUENCE customer_seq;
DROP table customer;

CREATE SEQUENCE  customer_seq  
START WITH 1 
INCREMENT BY 1;

drop table product;

CREATE TABLE product (
    id number(9,0),                       
    name varchar2(50) not null,           -- 상품명
    price number(9,0) not null,           -- 가격
    qty number(9,0) not null,             -- 수량
    CONSTRAINT product_pk PRIMARY KEY(id), 
    CONSTRAINT product_name_uk UNIQUE(name) 
); 

CREATE TABLE orders (
    id number(9,0),
    customerId number(9,0),
    productId number(9,0),
    CONSTRAINT orders_pk PRIMARY KEY(id),
    CONSTRAINT orders_customer_fk foreign key(customerId) references customer(id),
    CONSTRAINT orders_product_fk foreign key(productId) references product(id)
);

drop table orders;

drop sequence orders_seq;

CREATE SEQUENCE orders_seq
       INCREMENT BY 1
       START WITH 1;

INSERT INTO product(id, name, price, qty) VALUES(product_seq.nextval,'샴푸',3000,100);

INSERT INTO customer(id, username, password) VALUES(customer_seq.nextval, 'cos', '1234');

commit;

INSERT INTO orders(id, customerId, productId) VALUES(orders_seq.nextval,1,1);


UPDATE product set qty = qty-1 where id =1;

select *
FROM orders;

select *
FROM product;

